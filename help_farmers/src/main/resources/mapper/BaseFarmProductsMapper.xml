<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.help_farmers.mapper.BaseFarmProductsMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.help_farmers.model.domain.BaseFarmProducts">
        <id column="number" property="number" />
        <result column="name" property="name" />
        <result column="in_price" property="inPrice" />
        <result column="out_price" property="outPrice" />
        <result column="unit" property="unit" />
        <result column="farm_products_type_id" property="farmProductsTypeId" />
        <result column="remarks" property="remarks" />
        <result column="create_time" property="createTime" />
        <result column="create_by" property="createBy" />
        <result column="update_time" property="updateTime" />
        <result column="update_by" property="updateBy" />
        <result column="del_flag" property="delFlag" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        number, name, in_price, out_price, unit, farm_products_type_id, remarks, create_time, create_by, update_time, update_by, del_flag
    </sql>

    <select id="getFarmProductsList" resultType="com.help_farmers.model.vo.FarmProductsVo">
        SELECT
        fp.number,
        fp.name,
        fp.in_price,
        fp.out_price,
        fp.unit,
        fp.farm_products_type_id AS farmProductsTypeId,
        fpt.name AS farmProductsTypeName,
        fp.remarks,
        fp.create_time,
        fp.create_by,
        fp.update_time,
        fp.update_by
        FROM
        t_base_farm_products fp
        LEFT JOIN t_base_farm_products_type fpt ON fpt.id = fp.farm_products_type_id AND fpt.del_flag = 0
        <where>
            <if test="1 == 1">
                fp.del_flag = 0
            </if>
            <if test="number != null and number != ''">
                AND fp.number like concat('%', #{number},'%')
            </if>
            <if test="name != null and name != ''">
                AND fp.name like concat('%', #{name},'%')
            </if>
            <if test="farmProductsTypeId != null and farmProductsTypeId != ''">
                AND fpt.id = #{farmProductsTypeId}
            </if>
        </where>
    </select>

</mapper>
